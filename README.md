# Forgery-localization-for-remote-sensing

🔥 Congradualations! This paper has been accepted by IEEE Transactions on Geoscience and Remote Sensing! It is my second TGRS. Hope I can achieve a ISPRS in the near future!

The code for FLDCF: A Collaborative Framework for Forgery Localization and Detection in Satellite Imagery.

# Data preprocessing 🔨

Our datasets could be obtained from [link](https://pan.baidu.com/s/1ugHYZEfaoGLHosa8whbGiA) code：been (./data)


Put it into ./data and rename them as fakeV and fakeL.

```
├── Fake-Vaihingen/LoveDA
    ├── gt_mask <- the forgery mask for real images (a white image since no forgery)
    ├── test
    │   ├── gt             <- real images
    │   ├── inpainted_mask <- forgery mask for forgery images (lama and repaint)
    │   ├── lama           <- forgery images generated by lama
    │   └── repaint        <- forgery images generated by repaint    
    └── train
        ├── gt             
        ├── inpainted_mask
        ├── lama 
        └── repaint  
```

# Models 📝

Forgery detection

* Capsule  : [Capsule-forensics: Using capsule networks to detect forged images and videos](https://ieeexplore.ieee.org/abstract/document/8682602)
* FaceForensics : [Faceforensics++: Learning to detect manipulated facial images](https://openaccess.thecvf.com/content_ICCV_2019/html/Rossler_FaceForensics_Learning_to_Detect_Manipulated_Facial_Images_ICCV_2019_paper.html)
* DeepFake-Detection : Towards deepfake detection that actually works
* Geo-DefakeHop : [Geo-defakehop: High-performance geographic fake image detection](https://arxiv.org/abs/2110.09795)

Forgery localization

* SCSE-Unet : [Robust image forgery detection against transmission over online social networks](https://ieeexplore.ieee.org/abstract/document/9686650/)
* MVSSNet : [Mvss-net: Multi-view multi-scale supervised networks for image manipulation detection](https://ieeexplore.ieee.org/abstract/document/9789576)
* SE-Network : [Multi-task SE-network for image splicing localization](https://ieeexplore.ieee.org/abstract/document/9591639)

# Training and testing 🚆

* Train

1. Train content-based prior

option1: Trained by yourself. Put the final pretrain model into ./model and named it as model_lo.pt and model_vi.pt (for fakeL and fakeV). !! **Still under process. Now cannot use. Please choose option2.**

```
python src/main.py --data_train Vaihingengt --data_train_dir fakeV --model restore
```
I take fakeV as example. It could be changed to --data_train Lovadagt --data_train_dir fakeL.

option2: Download the pretrain model from [link](https://pan.baidu.com/s/1ugHYZEfaoGLHosa8whbGiA) code：been (./pretrain/prior) and put it into ./model

2. Train FLDCF

```
python src/main.py --data_train Vaihingen --data_train_dir fakeV --model fldcf
```

* Inference

```
python src/test.py --data_train Vaihingen --data_train_dir fakeV --model fldcf --pre_train ./model/model_fakeV.pt
```


# Trained checkpoints 💾

Our pretrain model could be obtained from [link](https://pan.baidu.com/s/1ugHYZEfaoGLHosa8whbGiA) code：been (./pretrain/fldcf)


## BibTeX 🙏

If you have any questions, be free to contact with me! I promise I will reply as soon as possible.
```
@ARTICLE{10756746,
  author={Sui, Jialu and Ma, Ding and Jay Kuo, C.-C. and Pun, Man-On},
  journal={IEEE Transactions on Geoscience and Remote Sensing}, 
  title={FLDCF: A Collaborative Framework for Forgery Localization and Detection in Satellite Imagery}, 
  year={2024},
  volume={62},
  pages={1-13},
  doi={10.1109/TGRS.2024.3502035}}
```
